name: British English Spelling Check

on:
  schedule:
    - cron: '0 0 1 * *'
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  anglicise:
    name: Check British English Spelling
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Generate App Token
        id: app_token
        uses: actions/create-github-app-token@v1
        with:
          app-id: ${{ secrets['XB_AI'] }}
          private-key: ${{ secrets['XB_PK'] }}

      - name: Setup bot identity
        uses: XAOSTECH/dev-control/.github/actions/identity@main
        with:
          gpg-private-key: ${{ secrets['XB_GK'] }}
          gpg-passphrase: ${{ secrets['XB_GP'] }}
          user-token: ${{ secrets['XB_UT'] }}
          bot-name: ${{ vars.BOT_NAME || 'xaos-bot' }}

      - name: Check for American spellings
        id: check
        run: |
          # British English Spelling Checker
          # Flags American spellings that should be converted to British equivalents
          #
          # Patterns checked:
          #   -ize ‚Üí -ise (organize ‚Üí organise)
          #   -ization ‚Üí -isation (organization ‚Üí organisation)
          #   -or ‚Üí -our (color ‚Üí colour)
          #   -er ‚Üí -re (center ‚Üí centre)
          #   -og ‚Üí -ogue (catalog ‚Üí catalogue)
          #   -ense ‚Üí -ence (defense ‚Üí defence)
          #   -l- ‚Üí -ll- (canceled ‚Üí cancelled)
          #   Other common differences (gray ‚Üí grey, etc.)

          ISSUES_FOUND=0
          ISSUE_OUTPUT=""

          # American words to check (case-insensitive matching)
          # Each line: american_word|british_word|pattern_category
          read -r -d '' WORD_PAIRS << 'WORDLIST' || true
          organize|organise|-ize ‚Üí -ise
          organizes|organises|-ize ‚Üí -ise
          organized|organised|-ize ‚Üí -ise
          organizing|organising|-ize ‚Üí -ise
          organization|organisation|-ization ‚Üí -isation
          organizations|organisations|-ization ‚Üí -isation
          organizational|organisational|-ization ‚Üí -isation
          recognize|recognise|-ize ‚Üí -ise
          recognizes|recognises|-ize ‚Üí -ise
          recognized|recognised|-ize ‚Üí -ise
          recognizing|recognising|-ize ‚Üí -ise
          customize|customise|-ize ‚Üí -ise
          customizes|customises|-ize ‚Üí -ise
          customized|customised|-ize ‚Üí -ise
          customizing|customising|-ize ‚Üí -ise
          customization|customisation|-ization ‚Üí -isation
          optimize|optimise|-ize ‚Üí -ise
          optimizes|optimises|-ize ‚Üí -ise
          optimized|optimised|-ize ‚Üí -ise
          optimizing|optimising|-ize ‚Üí -ise
          optimization|optimisation|-ization ‚Üí -isation
          optimizations|optimisations|-ization ‚Üí -isation
          initialize|initialise|-ize ‚Üí -ise
          initializes|initialises|-ize ‚Üí -ise
          initialized|initialised|-ize ‚Üí -ise
          initializing|initialising|-ize ‚Üí -ise
          initialization|initialisation|-ization ‚Üí -isation
          synchronize|synchronise|-ize ‚Üí -ise
          synchronizes|synchronises|-ize ‚Üí -ise
          synchronized|synchronised|-ize ‚Üí -ise
          synchronizing|synchronising|-ize ‚Üí -ise
          synchronization|synchronisation|-ization ‚Üí -isation
          authorize|authorise|-ize ‚Üí -ise
          authorizes|authorises|-ize ‚Üí -ise
          authorized|authorised|-ize ‚Üí -ise
          authorizing|authorising|-ize ‚Üí -ise
          authorization|authorisation|-ization ‚Üí -isation
          normalize|normalise|-ize ‚Üí -ise
          normalizes|normalises|-ize ‚Üí -ise
          normalized|normalised|-ize ‚Üí -ise
          normalizing|normalising|-ize ‚Üí -ise
          normalization|normalisation|-ization ‚Üí -isation
          visualize|visualise|-ize ‚Üí -ise
          visualizes|visualises|-ize ‚Üí -ise
          visualized|visualised|-ize ‚Üí -ise
          visualizing|visualising|-ize ‚Üí -ise
          visualization|visualisation|-ization ‚Üí -isation
          utilize|utilise|-ize ‚Üí -ise
          utilizes|utilises|-ize ‚Üí -ise
          utilized|utilised|-ize ‚Üí -ise
          utilizing|utilising|-ize ‚Üí -ise
          utilization|utilisation|-ization ‚Üí -isation
          finalize|finalise|-ize ‚Üí -ise
          finalizes|finalises|-ize ‚Üí -ise
          finalized|finalised|-ize ‚Üí -ise
          finalizing|finalising|-ize ‚Üí -ise
          localize|localise|-ize ‚Üí -ise
          localizes|localises|-ize ‚Üí -ise
          localized|localised|-ize ‚Üí -ise
          localizing|localising|-ize ‚Üí -ise
          localization|localisation|-ization ‚Üí -isation
          prioritize|prioritise|-ize ‚Üí -ise
          prioritizes|prioritises|-ize ‚Üí -ise
          prioritized|prioritised|-ize ‚Üí -ise
          prioritizing|prioritising|-ize ‚Üí -ise
          summarize|summarise|-ize ‚Üí -ise
          summarizes|summarises|-ize ‚Üí -ise
          summarized|summarised|-ize ‚Üí -ise
          summarizing|summarising|-ize ‚Üí -ise
          minimize|minimise|-ize ‚Üí -ise
          minimizes|minimises|-ize ‚Üí -ise
          minimized|minimised|-ize ‚Üí -ise
          minimizing|minimising|-ize ‚Üí -ise
          maximize|maximise|-ize ‚Üí -ise
          maximizes|maximises|-ize ‚Üí -ise
          maximized|maximised|-ize ‚Üí -ise
          maximizing|maximising|-ize ‚Üí -ise
          categorize|categorise|-ize ‚Üí -ise
          categorizes|categorises|-ize ‚Üí -ise
          categorized|categorised|-ize ‚Üí -ise
          categorizing|categorising|-ize ‚Üí -ise
          analyze|analyse|-ize ‚Üí -ise
          analyzes|analyses|-ize ‚Üí -ise
          analyzed|analysed|-ize ‚Üí -ise
          analyzing|analysing|-ize ‚Üí -ise
          analyzer|analyser|-ize ‚Üí -ise
          apologize|apologise|-ize ‚Üí -ise
          apologizes|apologises|-ize ‚Üí -ise
          apologized|apologised|-ize ‚Üí -ise
          apologizing|apologising|-ize ‚Üí -ise
          realize|realise|-ize ‚Üí -ise
          realizes|realises|-ize ‚Üí -ise
          realized|realised|-ize ‚Üí -ise
          realizing|realising|-ize ‚Üí -ise
          specialize|specialise|-ize ‚Üí -ise
          specializes|specialises|-ize ‚Üí -ise
          specialized|specialised|-ize ‚Üí -ise
          specializing|specialising|-ize ‚Üí -ise
          specialization|specialisation|-ization ‚Üí -isation
          standardize|standardise|-ize ‚Üí -ise
          standardizes|standardises|-ize ‚Üí -ise
          standardized|standardised|-ize ‚Üí -ise
          standardizing|standardising|-ize ‚Üí -ise
          standardization|standardisation|-ization ‚Üí -isation
          color|colour|-or ‚Üí -our
          colors|colours|-or ‚Üí -our
          colored|coloured|-or ‚Üí -our
          coloring|colouring|-or ‚Üí -our
          colorful|colourful|-or ‚Üí -our
          favor|favour|-or ‚Üí -our
          favors|favours|-or ‚Üí -our
          favored|favoured|-or ‚Üí -our
          favoring|favouring|-or ‚Üí -our
          favorable|favourable|-or ‚Üí -our
          favorite|favourite|-or ‚Üí -our
          favorites|favourites|-or ‚Üí -our
          honor|honour|-or ‚Üí -our
          honors|honours|-or ‚Üí -our
          honored|honoured|-or ‚Üí -our
          honoring|honouring|-or ‚Üí -our
          honorable|honourable|-or ‚Üí -our
          humor|humour|-or ‚Üí -our
          humors|humours|-or ‚Üí -our
          humored|humoured|-or ‚Üí -our
          humoring|humouring|-or ‚Üí -our
          humorous|humourous|-or ‚Üí -our
          labor|labour|-or ‚Üí -our
          labors|labours|-or ‚Üí -our
          labored|laboured|-or ‚Üí -our
          laboring|labouring|-or ‚Üí -our
          neighbor|neighbour|-or ‚Üí -our
          neighbors|neighbours|-or ‚Üí -our
          neighboring|neighbouring|-or ‚Üí -our
          neighborhood|neighbourhood|-or ‚Üí -our
          behavior|behaviour|-or ‚Üí -our
          behaviors|behaviours|-or ‚Üí -our
          behavioral|behavioural|-or ‚Üí -our
          flavor|flavour|-or ‚Üí -our
          flavors|flavours|-or ‚Üí -our
          flavored|flavoured|-or ‚Üí -our
          flavoring|flavouring|-or ‚Üí -our
          odor|odour|-or ‚Üí -our
          odors|odours|-or ‚Üí -our
          rumor|rumour|-or ‚Üí -our
          rumors|rumours|-or ‚Üí -our
          vapor|vapour|-or ‚Üí -our
          vapors|vapours|-or ‚Üí -our
          vigor|vigour|-or ‚Üí -our
          vigorous|vigourous|-or ‚Üí -our
          rigor|rigour|-or ‚Üí -our
          rigorous|rigourous|-or ‚Üí -our
          harbor|harbour|-or ‚Üí -our
          harbors|harbours|-or ‚Üí -our
          harbored|harboured|-or ‚Üí -our
          harboring|harbouring|-or ‚Üí -our
          savior|saviour|-or ‚Üí -our
          endeavor|endeavour|-or ‚Üí -our
          endeavors|endeavours|-or ‚Üí -our
          endeavored|endeavoured|-or ‚Üí -our
          endeavoring|endeavouring|-or ‚Üí -our
          center|centre|-er ‚Üí -re
          centers|centres|-er ‚Üí -re
          centered|centred|-er ‚Üí -re
          centering|centring|-er ‚Üí -re
          liter|litre|-er ‚Üí -re
          liters|litres|-er ‚Üí -re
          meter|metre|-er ‚Üí -re
          meters|metres|-er ‚Üí -re
          theater|theatre|-er ‚Üí -re
          theaters|theatres|-er ‚Üí -re
          fiber|fibre|-er ‚Üí -re
          fibers|fibres|-er ‚Üí -re
          caliber|calibre|-er ‚Üí -re
          specter|spectre|-er ‚Üí -re
          specters|spectres|-er ‚Üí -re
          scepter|sceptre|-er ‚Üí -re
          somber|sombre|-er ‚Üí -re
          defense|defence|-ense ‚Üí -ence
          defenses|defences|-ense ‚Üí -ence
          offense|offence|-ense ‚Üí -ence
          offenses|offences|-ense ‚Üí -ence
          pretense|pretence|-ense ‚Üí -ence
          analog|analogue|-og ‚Üí -ogue
          analogs|analogues|-og ‚Üí -ogue
          catalog|catalogue|-og ‚Üí -ogue
          catalogs|catalogues|-og ‚Üí -ogue
          cataloged|catalogued|-og ‚Üí -ogue
          cataloging|cataloguing|-og ‚Üí -ogue
          dialog|dialogue|-og ‚Üí -ogue
          dialogs|dialogues|-og ‚Üí -ogue
          prolog|prologue|-og ‚Üí -ogue
          epilog|epilogue|-og ‚Üí -ogue
          canceled|cancelled|-l- ‚Üí -ll-
          canceling|cancelling|-l- ‚Üí -ll-
          traveled|travelled|-l- ‚Üí -ll-
          traveling|travelling|-l- ‚Üí -ll-
          traveler|traveller|-l- ‚Üí -ll-
          travelers|travellers|-l- ‚Üí -ll-
          modeled|modelled|-l- ‚Üí -ll-
          modeling|modelling|-l- ‚Üí -ll-
          labeled|labelled|-l- ‚Üí -ll-
          labeling|labelling|-l- ‚Üí -ll-
          leveled|levelled|-l- ‚Üí -ll-
          leveling|levelling|-l- ‚Üí -ll-
          signaled|signalled|-l- ‚Üí -ll-
          signaling|signalling|-l- ‚Üí -ll-
          fueled|fuelled|-l- ‚Üí -ll-
          fueling|fuelling|-l- ‚Üí -ll-
          counseled|counselled|-l- ‚Üí -ll-
          counseling|counselling|-l- ‚Üí -ll-
          counselor|counsellor|-l- ‚Üí -ll-
          counselors|counsellors|-l- ‚Üí -ll-
          gray|grey|gray ‚Üí grey
          grays|greys|gray ‚Üí grey
          grayish|greyish|gray ‚Üí grey
          aging|ageing|aging ‚Üí ageing
          judgment|judgement|judgment ‚Üí judgement
          judgments|judgements|judgment ‚Üí judgement
          acknowledgment|acknowledgement|acknowledgment ‚Üí acknowledgement
          acknowledgments|acknowledgements|acknowledgment ‚Üí acknowledgement
          fulfill|fulfil|fulfill ‚Üí fulfil
          fulfills|fulfils|fulfill ‚Üí fulfil
          fulfilled|fulfilled|fulfill ‚Üí fulfil
          fulfilling|fulfilling|fulfill ‚Üí fulfil
          fulfillment|fulfilment|fulfillment ‚Üí fulfilment
          skillful|skilful|skillful ‚Üí skilful
          skillfully|skilfully|skillful ‚Üí skilful
          willful|wilful|willful ‚Üí wilful
          willfully|wilfully|willful ‚Üí wilful
          enroll|enrol|enroll ‚Üí enrol
          enrolls|enrols|enroll ‚Üí enrol
          enrolled|enrolled|enroll ‚Üí enrol
          enrolling|enrolling|enroll ‚Üí enrol
          enrollment|enrolment|enrollment ‚Üí enrolment
          installment|instalment|installment ‚Üí instalment
          installments|instalments|installment ‚Üí instalment
          plow|plough|plow ‚Üí plough
          plows|ploughs|plow ‚Üí plough
          plowed|ploughed|plow ‚Üí plough
          plowing|ploughing|plow ‚Üí plough
          WORDLIST

          # Find files to check
          FILES=$(find . -type f \( -name "*.md" -o -name "*.sh" -o -name "*.yaml" -o -name "*.yml" -o -name "*.txt" \) \
            ! -path "./.git/*" \
            ! -path "./node_modules/*" \
            ! -path "./vendor/*" \
            ! -path "./.github/workflows/*" \
            ! -path "./workflows-templates/anglicise.yml" \
            ! -path "./license-templates/*" \
            2>/dev/null | sort)

          echo "## British English Spelling Check" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "üîç Checking $(echo "$FILES" | wc -l) files for American spellings..." | tee -a $GITHUB_STEP_SUMMARY
          echo ""

          # Track files needing fixes
          declare -A FILES_TO_FIX

          # Process each word pair
          while IFS='|' read -r american british pattern; do
            [[ -z "$american" ]] && continue
            
            echo "üìù Checking for: $american ‚Üí $british"
            
            # Search for word (case-insensitive, whole word)
            while IFS= read -r file; do
              [[ -z "$file" ]] && continue
              
              # Find matches, excluding:
              # - URLs and shields.io badge URL parameters (&color=, ?color=)
              # - CLI flags with values (--align center, --foreground color)
              # - Gum/TUI library options
              # - Variable references ($color, ${color})
              # - Assignment patterns (color=, COLOR=) including query params
              MATCHES=$(grep -inw "$american" "$file" 2>/dev/null | \
                grep -vE '(https?://|file://|[?&](color|center|gray)=[a-zA-Z0-9]+|"Authorization": "Bearer|types:[[:space:]]*\[[^]]+\]|--[a-z-]+ (center|color|gray)|\$\{?(color|center|gray)|}|\b(color|center|gray)[_A-Z]*=|gum |\\$)' || true)
              
              if [[ -n "$MATCHES" ]]; then
                FILES_TO_FIX["$file"]=1
                while IFS= read -r match; do
                  [[ -z "$match" ]] && continue
                  LINE_NUM=$(echo "$match" | cut -d: -f1)
                  LINE_CONTENT=$(echo "$match" | cut -d: -f2- | sed 's/^[[:space:]]*//' | head -c 100)
                  
                  echo "  ‚ùå $file:$LINE_NUM - '$american' ‚Üí '$british'"
                  ISSUE_OUTPUT+="| \`$file:$LINE_NUM\` | $american | $british | $pattern |"$'\n'
                  ISSUES_FOUND=$((ISSUES_FOUND + 1))
                done <<< "$MATCHES"
              fi
            done <<< "$FILES"
          done <<< "$WORD_PAIRS"

          # Save word pairs for fixing step
          echo "$WORD_PAIRS" > /tmp/word_pairs.txt

          # Output results
          echo ""
          if [[ $ISSUES_FOUND -gt 0 ]]; then
            echo "‚ùå Found $ISSUES_FOUND American spelling(s) in ${#FILES_TO_FIX[@]} file(s)"
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚ùå **Found $ISSUES_FOUND American spelling(s) to convert**" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "| Location | American üá∫üá∏ | British üá¨üáß | Pattern |" >> $GITHUB_STEP_SUMMARY
            echo "|----------|-------------|------------|---------|" >> $GITHUB_STEP_SUMMARY
            echo "$ISSUE_OUTPUT" >> $GITHUB_STEP_SUMMARY
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "üîß **A pull request will be created with automatic fixes.**" >> $GITHUB_STEP_SUMMARY
            
            echo "needs_fix=true" >> $GITHUB_OUTPUT
          else
            echo "‚úÖ All spellings conform to British English standards."
            echo "" >> $GITHUB_STEP_SUMMARY
            echo "‚úÖ **All spellings conform to British English standards.**" >> $GITHUB_STEP_SUMMARY
            echo "needs_fix=false" >> $GITHUB_OUTPUT
          fi

      - name: Apply British English fixes
        if: steps.check.outputs.needs_fix == 'true'
        run: |
          echo "üîß Applying British English conversions..."
          
          # Read word pairs
          WORD_PAIRS=$(cat /tmp/word_pairs.txt)
          
          # Find files to fix (same criteria as check)
          FILES=$(find . -type f \( -name "*.md" -o -name "*.sh" -o -name "*.yaml" -o -name "*.yml" -o -name "*.txt" \) \
            ! -path "./.git/*" \
            ! -path "./node_modules/*" \
            ! -path "./vendor/*" \
            ! -path "./.github/workflows/*" \
            ! -path "./workflows-templates/anglicise.yml" \
            ! -path "./license-templates/*" \
            2>/dev/null)
          
          FIXED_COUNT=0
          
          # Case-preserving replacement function
          # Replaces american with british while preserving the original case pattern
          case_preserve_replace() {
            local file="$1"
            local american="$2"
            local british="$3"
            
            # Create temp file
            local tmpfile=$(mktemp)
            
            # Process line by line to preserve case and skip certain patterns
            while IFS= read -r line || [[ -n "$line" ]]; do
              # Skip lines containing:
              # - HTML attributes (align="center", style="color:")
              # - CLI flags with values (--align center, --foreground color)
              # - Gum/TUI commands and options
              # - Variable references ($color, ${color}, COLOR_VAR)
              # - Assignment patterns (color=, center=)
              # - Escaped line continuations (trailing backslash)
              # NOTE: filename exclusion is handled in the perl regex via (?!\.)
              # so that 'colors' in a comment is fixed even if 'colours.sh' appears on the same line
              if echo "$line" | grep -qE "(=[\"'](center|color)|types:[[:space:]]*\[[^]]+\]|--[a-z-]+ (center|color|gray)|--color|--center|\\$\\{?(color|center|gray)|\\b(COLOR|CENTER|GRAY)[_A-Z]*=|gum |\\\\$)"; then
                echo "$line"
              else
                # Apply case-preserving replacement using perl
                # (?!\.) prevents replacing when the word is directly followed by a dot (e.g. colors.sh)
                echo "$line" | perl -pe "
                  s/\\b${american}\\b(?!\\.)/
                    my \$match = \$&;
                    my \$repl = '${british}';
                    if (\$match =~ \/^[A-Z]+\$\/) {
                      # ALL CAPS
                      uc(\$repl);
                    } elsif (\$match =~ \/^[A-Z]\/) {
                      # Title Case
                      ucfirst(\$repl);
                    } else {
                      # lowercase
                      \$repl;
                    }
                  /gei"
              fi
            done < "$file" > "$tmpfile"
            
            # Replace original file
            mv "$tmpfile" "$file"
          }
          
          # Apply replacements
          while IFS='|' read -r american british pattern; do
            [[ -z "$american" ]] && continue
            
            while IFS= read -r file; do
              [[ -z "$file" ]] && continue
              
              # Check if file contains the word (case-insensitive, whole word)
              # Exclude lines where the match is inside a code/CLI pattern (filename exclusion handled by perl (?!\.))
              if grep -inw "$american" "$file" 2>/dev/null | grep -qvE "(https?://|[?&](color|center|gray)=[a-zA-Z0-9]+|\"Authorization\": \"Bearer|types:[[:space:]]*\[[^]]+\]|=[\"'](center|color)|--[a-z-]+ (center|color|gray)|--color|--center|\\$\\{?(color|center|gray)|\\b(COLOR|CENTER|GRAY)[_A-Z]*|gum |\\\\$)"; then
                case_preserve_replace "$file" "$american" "$british"
                echo "  ‚úì Fixed in: $file"
                FIXED_COUNT=$((FIXED_COUNT + 1))
              fi
            done <<< "$FILES"
          done <<< "$WORD_PAIRS"
          
          echo "‚úÖ Applied fixes to $FIXED_COUNT file(s)"

      - name: Setup bot identity (if fixes needed)
        id: import_gpg
        if: steps.check.outputs.needs_fix == 'true'
        uses: XAOSTECH/dev-control/.github/actions/identity@main
        with:
          gpg-private-key: ${{ secrets['XB_GK'] }}
          gpg-passphrase: ${{ secrets['XB_GP'] }}
          user-token: ${{ secrets['XB_UT'] }}
          bot-name: ${{ vars.BOT_NAME || 'xaos-bot' }}

      - name: Ensure automerge label exists
        if: steps.check.outputs.needs_fix == 'true'
        env:
          GH_TOKEN: ${{ steps.app_token.outputs.token }}
        run: |
          # Create 'automerge' label if it doesn't exist
          gh label create automerge \
            --description "Automatically merge this PR" \
            --color "3BEF67" \
            2>/dev/null || true
          echo "‚úÖ Automerge label ensured"

      - name: Create Pull Request
        if: steps.check.outputs.needs_fix == 'true'
        env:
          GH_TOKEN: ${{ steps.app_token.outputs.token }}
        run: |
          # Stage changes first to check if there are any
          git add -A
          
          # Check if there are actual changes to commit
          if git diff --cached --quiet; then
            echo "‚úÖ No changes needed - all spellings already conform to British English"
            echo "‚ÑπÔ∏è The check step found potential issues but the fix step determined they were false positives."
            echo "   This can happen when matches are in excluded patterns (URLs, CLI flags, etc.)"
            exit 0
          fi
          
          # Create branch only if we have changes
          BRANCH_NAME="anglicise/$(date +%Y%m%d-%H%M%S)"
          git checkout -b "$BRANCH_NAME"
          
          # Commit
          git commit -m "chore: convert American spellings to British English" -m "Automated conversion of American spellings to British equivalents:" -m "- -ize ‚Üí -ise (organize ‚Üí organise)" -m "- -or ‚Üí -our (color ‚Üí colour)" -m "- -er ‚Üí -re (center ‚Üí centre)" -m "- -og ‚Üí -ogue (catalog ‚Üí catalogue)" -m "- -ense ‚Üí -ence (defense ‚Üí defence)" -m "- -l- ‚Üí -ll- (canceled ‚Üí cancelled)" -m "- gray ‚Üí grey, aging ‚Üí ageing, etc."
          
          # Push branch
          git push origin "$BRANCH_NAME"
          
          # Create PR
          gh pr create \
            --title "chore: Convert American spellings to British English" \
            --body "## Automated British English Conversion\n\nThis PR automatically converts American spellings to British English equivalents.\n\n### Patterns converted:\n- \`-ize\` ‚Üí \`-ise\` (organize ‚Üí organise)\n- \`-ization\` ‚Üí \`-isation\` (organization ‚Üí organisation)\n- \`-or\` ‚Üí \`-our\` (color ‚Üí colour)\n- \`-er\` ‚Üí \`-re\` (center ‚Üí centre)\n- \`-og\` ‚Üí \`-ogue\` (catalog ‚Üí catalogue)\n- \`-ense\` ‚Üí \`-ence\` (defense ‚Üí defence)\n- \`-l-\` ‚Üí \`-ll-\` (canceled ‚Üí cancelled)\n- Other common differences (gray ‚Üí grey, aging ‚Üí ageing, etc.)\n\n### Review notes:\n- All replacements use case-insensitive whole-word matching\n- File paths, URLs, and code identifiers are preserved\n- Please review the changes to ensure no false positives\n\n---
            *Generated by [British English Spelling Check workflow](${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }})*" \
            --base "${{ github.ref_name }}" \
            --head "$BRANCH_NAME" \
            --label "automerge"
          
          echo "‚úÖ Pull request created successfully"
